<div class="mb-5">
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <h1 class="h3 fw-bold text-primary">Mis Beneficiarios</h1>
      <p class="text-muted">Gestiona tu lista de beneficiarios para transferencias</p>
    </div>
    <a href="/client/beneficiaries/new" class="btn btn-primary d-flex align-items-center">
      <i class="bi bi-plus me-2"></i> Agregar Beneficiario
    </a>
  </div>
</div>

<!-- Card -->
<div class="card">
  <div class="card-header">
    <h5 class="mb-0">Lista de Beneficiarios</h5>
    <small class="text-muted">Personas a las que puedes enviar dinero de forma rápida</small>

    <div class="position-relative mt-3">
      <i class="bi bi-search position-absolute top-50 translate-middle-y start-2 text-muted ms-2"></i>
      <input
        type="text"
        class="form-control ps-5"
        placeholder="Buscar por nombre, cuenta o banco..."
        [(ngModel)]="searchTerm"
      />
    </div>
  </div>

  <div class="card-body p-0">
    <table class="table table-hover align-middle mb-0" *ngIf="filteredBeneficiaries().length > 0; else emptyState">
      <thead class="table-light">
      <tr>
        <th>Nombre</th>
        <th>Número de Cuenta</th>
        <th>Banco</th>
        <th>Estado</th>
        <th class="text-end">Acciones</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let b of filteredBeneficiaries()">
        <td>
          <div class="fw-medium">{{ b.name }}</div>
          <div class="text-muted small">{{ b.email }}</div>
        </td>
        <td class="fw-medium">{{ b.accountNumber }}</td>
        <td>{{ b.bank }}</td>
        <td>
          <span class="badge bg-success">Activo</span>
        </td>
        <td class="text-end">
          <div class="dropdown">
            <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
              <i class="bi bi-three-dots-vertical"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li class="dropdown-header">Acciones</li>
              <li>
                <a class="dropdown-item" [href]="'/client/transfer?beneficiary=' + b.id">
                  <i class="bi bi-person-check me-2"></i> Transferir
                </a>
              </li>
              <li>
                <button class="dropdown-item text-danger" (click)="deleteBeneficiary(b.id, b.name)">
                  <i class="bi bi-trash me-2"></i> Eliminar
                </button>
              </li>
            </ul>
          </div>
        </td>
      </tr>
      </tbody>
    </table>

    <!-- Estado vacío -->
    <ng-template #emptyState>
      <div class="text-center py-5">
        <i class="bi bi-person-check text-muted display-6"></i>
        <h5 class="mt-3">No hay beneficiarios</h5>
        <p class="text-muted">Comienza agregando tu primer beneficiario para realizar transferencias.</p>
        <a href="/client/beneficiaries/new" class="btn btn-primary d-flex align-items-center justify-content-center mt-3">
          <i class="bi bi-plus me-2"></i> Agregar Beneficiario
        </a>
      </div>
    </ng-template>
  </div>
</div>
